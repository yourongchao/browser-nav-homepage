<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>浏览器导航主页</title>
    <link rel="stylesheet" href="./style.css">
</head>
<body>
    <!-- 壁纸背景 -->
    <div id="wallpaper" class="wallpaper"></div>

    <!--主 内容区域 -->
    <main class="container">
        <header class="header">
            <div class="search-component">
                <div class="search-left">
                    <select id="search-engine" class="search-engine-select">
                    <option value="google">Google</option>
                    <option value="baidu">百度</option>
                    <option value="bing">Bing</option>
                    <option value="yahoo">Yahoo</option>
                    <option value="local">本地</option>
                </select>
                </div>
                <div class="search-center">
                    <div class="search-input-container">
                        <input type="text" id="search-input" class="search-input" placeholder="搜索...">
                    </div>
                </div>
                <div class="search-right">
                    <button id="settings-toggle" class="settings-toggle" type="button">设置</button>
                </div>
            </div>
        </header>

        <!-- 标签筛选面板 -->
    <div id="tag-filter-panel" class="tag-filter-panel">
        <div class="tag-filter-header">
            <h3>标签筛选</h3>
            <button id="clear-tag-filter" class="btn-small btn-secondary">清除筛选</button>
        </div>
        <div id="tag-filter-list" class="tag-filter-list">
            <!-- 标签筛选选项通过JavaScript动态生成 -->
        </div>
    </div>

    <!-- 导航网格 -->
    <div id="nav-grid" class="nav-grid">
        <!-- 导航项通过JavaScript动态生成 -->
    </div>

    <!-- 添加导航项按钮（仅在设置模式下显示） -->
    <button id="add-nav-btn" class="add-nav-btn" type="button">+ 添加快捷方式</button>
    </main>

    <!-- 图标右键菜单 -->
    <div id="icon-context-menu" class="context-menu">
        <ul>
            <li data-action="edit">编辑网址</li>
            <li data-action="delete">删除</li>
            <li data-action="move-up">上移</li>
            <li data-action="move-down">下移</li>
            <li data-action="add-to-tool-group">添加到工具组</li>
        </ul>
    </div>

    <!-- 工具组右键菜单 -->
    <div id="toolgroup-context-menu" class="context-menu">
        <ul>
            <li data-action="edit-toolgroup">编辑工具组</li>
            <li data-action="add-item">添加项</li>
            <li data-action="remove-item">删除项</li>
            <li data-action="delete-toolgroup">删除工具组</li>
        </ul>
    </div>

    <!-- 工具组展开面板 -->
    <div id="toolgroup-panel" class="toolgroup-panel">
        <div class="toolgroup-panel-content">
            <div class="toolgroup-panel-header">
                <h3 id="toolgroup-panel-title">工具组</h3>
                <button id="close-toolgroup-panel" class="close-btn" type="button">×</button>
            </div>
            <div id="toolgroup-items" class="toolgroup-items"></div>
        </div>
    </div>

    <!-- 工具组选择模态框 -->
    <div id="toolgroup-select-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>选择工具组</h3>
                <button class="close-modal" type="button">×</button>
            </div>
            <div class="modal-body">
                <div id="toolgroup-select-list"></div>
                <button id="create-new-toolgroup" class="btn secondary" type="button">创建新工具组</button>
                <div class="form-buttons">
                    <button type="button" class="btn primary select-toolgroup">确认</button>
                    <button type="button" class="btn secondary close-modal">取消</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 确认删除模态框 -->
    <div id="confirm-delete-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>确认删除</h3>
                <button class="close-modal" type="button">×</button>
            </div>
            <div class="modal-body">
                <p id="confirm-delete-message">确定要执行此操作吗？</p>
                <div class="form-buttons">
                    <button type="button" id="confirm-delete-ok" class="btn primary">确定</button>
                    <button type="button" id="confirm-delete-cancel" class="btn secondary close-modal">取消</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 工具组编辑模态框 -->
    <div id="toolgroup-edit-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="toolgroup-edit-title">编辑工具组</h3>
                <button class="close-modal" type="button">×</button>
            </div>
            <div class="modal-body">
                <form id="toolgroup-edit-form">
                    <div class="form-group">
                        <label for="toolgroup-name">工具组名称</label>
                        <input type="text" id="toolgroup-name" required>
                    </div>
                    <div class="form-buttons">
                        <button type="submit" class="btn primary">保存</button>
                        <button type="button" class="btn secondary close-modal">取消</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 壁纸右键菜单 -->
    <div id="wallpaper-context-menu" class="context-menu">
        <ul>
            <li data-action="set-wallpaper">设置壁纸</li>
            <li data-action="add-custom-url">添加自定义网址</li>
            <li data-action="nav-settings">导航设置</li>
            <li data-action="open-settings">打开设置面板</li>
        </ul>
    </div>

    <!-- 设置面板 -->
    <div id="settings-panel" class="settings-panel">
        <div class="settings-header">
            <h2>设置</h2>
            <button id="close-settings" class="close-btn" type="button">×</button>
        </div>
        <div class="settings-content">
            <!-- 壁纸设置 -->
            <section class="settings-section">
                <h3>壁纸设置</h3>
                <div class="form-group">
                    <div class="form-row wallpaper-controls">
                        <div class="custom-file-upload">
                            <input type="file" id="wallpaper-upload" accept="image/*">
                            <span>上传壁纸</span>
                        </div>
                        <button id="reset-wallpaper" class="btn secondary" type="button">恢复默认壁纸</button>
                    </div>
                    <div class="preview-container">
                        <div id="wallpaper-preview" class="wallpaper-preview"></div>
                    </div>
                </div>
            </section>

            <!-- 导航管理 -->
            <section class="settings-section">
                <h3>导航管理</h3>
                <div id="nav-list" class="nav-list">
                    <!-- 导航项列表通过JavaScript动态生成 -->
                </div>
                <button id="add-nav-item" class="btn primary" type="button">添加新导航项</button>
            </section>

            <!-- 工具组管理 -->
            <section class="settings-section">
                <h3>工具组管理</h3>
                <div id="toolgroup-list" class="nav-list">
                    <!-- 工具组列表通过JavaScript动态生成 -->
                </div>
                <button id="add-toolgroup" class="btn primary" type="button">添加新工具组</button>
            </section>

            <!-- 布局调整 -->
            <section class="settings-section">
                <h3>布局调整</h3>
                <div class="form-group">
                        <label for="columns">列数：<span id="columns-value">8</span></label>
                        <input type="range" id="columns" min="6" max="10" value="8" class="slider">
                    </div>
                <div class="form-group">
                    <label for="spacing">间距：<span id="spacing-value">10</span>px</label>
                    <input type="range" id="spacing" min="5" max="30" value="10" class="slider">
                </div>
                <div class="form-group">
                    <label for="icon-size">图标大小：<span id="icon-size-value">48</span>px</label>
                    <input type="range" id="icon-size" min="32" max="80" value="48" class="slider">
                </div>
                <div class="form-group">
                    <label for="search-opacity">搜索框透明度：<span id="search-opacity-value">80</span>%</label>
                    <input type="range" id="search-opacity" min="10" max="100" value="80" class="slider">
                </div>
            </section>

            <!-- 外观设置 -->
            <section class="settings-section">
                <h3>外观设置</h3>
                <div class="form-group">
                    <label for="text-color">快捷方式文字颜色</label>
                    <div class="form-row wallpaper-controls">
                        <div class="color-picker-container">
                            <input type="color" id="text-color" class="color-picker" value="#2d3748">
                            <input type="text" id="text-color-hex" class="color-hex-input" placeholder="#2d3748">
                        </div>
                        <button id="reset-text-color" class="btn secondary" type="button">恢复默认颜色</button>
                    </div>
                    <div class="color-preview-container">
                        <div class="color-preview" id="color-preview">
                            <div class="preview-text">文字预览</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 数据管理 -->
            <section class="settings-section">
                <h3>数据管理</h3>
                <div class="form-group">
                    <button id="export-data" class="btn secondary" type="button">导出设置</button>
                    <button id="import-data" class="btn secondary" type="button">导入设置</button>
                    <input type="file" id="import-file" accept=".json" style="display: none;">
                    <button id="reset-data" class="btn danger" type="button">重置</button>
                </div>
                <div class="form-group">
                    <h4>文件存储设置</h4>
                    <div class="form-row">
                        <label class="checkbox-label">
                            <input type="checkbox" id="enable-file-storage">
                            启用本地文件存储
                        </label>
                    </div>
                    <div class="form-row">
                        <button id="select-storage-file" class="btn secondary" type="button">选择文件</button>

                        <button id="restore-backup" class="btn secondary" type="button">从文件恢复</button>
                    </div>
                    <button id="storage-info-btn" class="btn secondary" type="button">ℹ️ 存储说明</button>
                </div>
            </section>
        </div>
    </div>

    <!-- 存储信息模态框 -->
    <div id="storage-info-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>文件存储说明</h3>
                <button class="close-modal" type="button">×</button>
            </div>
            <div class="modal-body">
                <div class="storage-info-content">
                    <small>启用文件存储后,您的设置将自动保存到本地JSON文件中,提供额外的数据安全性和备份选项。</small>
                    <small><strong>兼容性说明：</strong>文件存储功能支持Chrome 86+、Edge 86+、Opera浏览器以及Firefox浏览器。Firefox浏览器使用替代方案实现本地文件存储，提供相同的数据安全性和备份选项。如果您的浏览器不支持此功能，系统将默认使用localStorage进行数据存储。</small>
                </div>
            </div>
        </div>
    </div>

    <!-- 编辑模态框 -->
    <div id="edit-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>添加导航项</h3>
                <button class="close-modal" type="button">×</button>
            </div>
            <div class="modal-body">
                <form id="edit-form">
                    <div class="form-group">
                        <input type="text" id="edit-name" required placeholder="名称">
                        <label for="edit-name">名称</label>
                    </div>
                    <div class="form-group">
                        <input type="text" id="edit-url" required placeholder="网址">
                        <label for="edit-url">网址</label>
                    </div>
                    <div class="form-group">
                        <input type="text" id="edit-icon-url" placeholder="图标在线网址（可选）">
                        <label for="edit-icon-url">图标在线网址（可选）</label>
                    </div>
                    <div class="form-group">
                        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                            <label class="custom-file-upload" for="edit-icon">
                                选择图标
                            </label>
                            <div id="icon-preview" class="icon-preview">
                                <div class="icon-loading" style="display: none;">获取中...</div>
                            </div>
                        </div>
                        <input type="file" id="edit-icon" accept="image/*">
                    </div>
                    <!-- 标签管理 -->
                    <div class="form-group">
                        <label for="edit-tags">标签</label>
                        <div class="tags-container">
                            <div id="edit-selected-tags" class="selected-tags"></div>
                            <div class="tag-input-group">
                                <input type="text" id="edit-tag-input" placeholder="输入标签名称" class="tag-input">
                                <button type="button" id="add-edit-tag" class="btn btn-small primary">添加</button>
                            </div>
                        </div>
                    </div>
                    <div class="form-buttons">
                        <button type="button" id="save-and-continue" class="btn primary">保存并继续</button>
                        <button type="submit" class="btn primary">保存</button>
                        <button type="button" class="btn secondary close-modal">取消</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 编辑现有导航项模态框 -->
    <div id="edit-existing-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>编辑导航项</h3>
                <button class="close-modal" type="button">×</button>
            </div>
            <div class="modal-body">
                <form id="edit-existing-form">
                    <div class="form-group">
                        <input type="text" id="edit-existing-name" required placeholder="名称">
                        <label for="edit-existing-name">名称</label>
                    </div>
                    <div class="form-group">
                        <input type="text" id="edit-existing-url" required placeholder="网址">
                        <label for="edit-existing-url">网址</label>
                    </div>
                    <div class="form-group">
                        <input type="text" id="edit-existing-icon-url" placeholder="图标在线网址（可选）">
                        <label for="edit-existing-icon-url">图标在线网址（可选）</label>
                    </div>
                    <div class="form-group">
                        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                            <label class="custom-file-upload" for="edit-existing-icon">
                                选择图标
                            </label>
                            <div id="icon-existing-preview" class="icon-preview">
                                <div class="icon-loading" style="display: none;">获取中...</div>
                            </div>
                        </div>
                        <input type="file" id="edit-existing-icon" accept="image/*">
                    </div>
                    <!-- 标签管理 -->
                    <div class="form-group">
                        <label for="edit-existing-tags">标签</label>
                        <div class="tags-container">
                            <div id="edit-existing-selected-tags" class="selected-tags"></div>
                            <div class="tag-input-group">
                                <input type="text" id="edit-existing-tag-input" placeholder="输入标签名称" class="tag-input">
                                <button type="button" id="add-edit-existing-tag" class="btn btn-small primary">添加</button>
                            </div>
                        </div>
                    </div>
                    <div class="form-buttons">
                        <button type="submit" class="btn primary">保存</button>
                        <button type="button" class="btn secondary close-modal">取消</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 消息提示 -->
    <div id="toast" class="toast"></div>

    <script src="./script.js"></script>
</body>
</html>